<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="django," />





  <link rel="alternate" href="/atom.xml" title="笑傲江湖" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="对于某一类网站， 管理界面 是基础设施中非常重要的一部分。 这是以网页和有限的可信任管理者为基础的界面，它可以让你添加，编辑和删除网站内容。 一些常见的例子： 你可以用这个界面发布博客，后台的网站管理者用它来润色读者提交的内容，你的客户用你给他们建立的界面工具更新新闻并发布在网站上，这些都是使用管理界面的例子。
但是管理界面有一问题： 创建它太繁琐。 当你开发对公众的功能时，网页开发是有趣的，但是">
<meta property="og:type" content="article">
<meta property="og:title" content="第六章 Django站点管理">
<meta property="og:url" content="http://www.lflxp.cn/2016/04/06/2016-02-03-第六章 Django站点管理/index.html">
<meta property="og:site_name" content="笑傲江湖">
<meta property="og:description" content="对于某一类网站， 管理界面 是基础设施中非常重要的一部分。 这是以网页和有限的可信任管理者为基础的界面，它可以让你添加，编辑和删除网站内容。 一些常见的例子： 你可以用这个界面发布博客，后台的网站管理者用它来润色读者提交的内容，你的客户用你给他们建立的界面工具更新新闻并发布在网站上，这些都是使用管理界面的例子。
但是管理界面有一问题： 创建它太繁琐。 当你开发对公众的功能时，网页开发是有趣的，但是">
<meta property="og:updated_time" content="2016-04-06T11:26:18.136Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第六章 Django站点管理">
<meta name="twitter:description" content="对于某一类网站， 管理界面 是基础设施中非常重要的一部分。 这是以网页和有限的可信任管理者为基础的界面，它可以让你添加，编辑和删除网站内容。 一些常见的例子： 你可以用这个界面发布博客，后台的网站管理者用它来润色读者提交的内容，你的客户用你给他们建立的界面工具更新新闻并发布在网站上，这些都是使用管理界面的例子。
但是管理界面有一问题： 创建它太繁琐。 当你开发对公众的功能时，网页开发是有趣的，但是">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 6270391365704615000,
      author: '博主'
    }
  };
</script>

  <title> 第六章 Django站点管理 | 笑傲江湖 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?eb05bb32276230ed42405c8e64b1be45";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">笑傲江湖</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">思想与技术的碰撞</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-heartbeat fa-fw"></i> <br />
            
            公益404
          </a>
        </li>
      
        
        <li class="menu-item menu-item-something">
          <a href="/something" rel="section">
            
              <i class="menu-item-icon fa fa-fighter-jet fa-fw"></i> <br />
            
            有料哟
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', '_VYNMxKzPVW1G-MrUtKi','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                第六章 Django站点管理
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-04-06T18:31:45+08:00" content="2016-04-06">
              2016-04-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Django-book-2-0/" itemprop="url" rel="index">
                    <span itemprop="name">Django book 2.0</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/04/06/2016-02-03-第六章 Django站点管理/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/04/06/2016-02-03-第六章 Django站点管理/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>对于某一类网站， 管理界面 是基础设施中非常重要的一部分。 这是以网页和有限的可信任管理者为基础的界面，它可以让你添加，编辑和删除网站内容。 一些常见的例子： 你可以用这个界面发布博客，后台的网站管理者用它来润色读者提交的内容，你的客户用你给他们建立的界面工具更新新闻并发布在网站上，这些都是使用管理界面的例子。</p>
<p>但是管理界面有一问题： 创建它太繁琐。 当你开发对公众的功能时，网页开发是有趣的，但是创建管理界面通常是千篇一律的。 你必须认证用户，显示并管理表格，验证输入的有效性诸如此类。 这很繁琐而且是重复劳动。</p>
<p>Django 在对这些繁琐和重复的工作进行了哪些改进？ 它用不能再少的代码为你做了所有的一切。 Django 中创建管理界面已经不是问题。</p>
<p>这一章是关于 Django 的自动管理界面。 这个特性是这样起作用的： 它读取你模式中的元数据，然后提供给你一个强大而且可以使用的界面，网站管理者可以用它立即工作。</p>
<p>请注意我们建议你读这章，即使你不打算用admin。因为我们将介绍一些概念，这些概念可以应用到Django的所有方面，而不仅仅是admin<br>django.contrib 包</p>
<p>Django自动管理工具是django.contrib的一部分。django.contrib是一套庞大的功能集，它是Django基本代码的组成部分，Django框架就是由众多包含附加组件(add-on)的基本代码构成的。 你可以把django.contrib看作是可选的Python标准库或普遍模式的实际实现。 它们与Django捆绑在一起，这样你在开发中就不用“重复发明轮子”了。</p>
<p>管理工具是本书讲述django.contrib的第一个部分。从技术层面上讲，它被称作django.contrib.admin。django.contrib中其它可用的特性，如用户鉴别系统(django.contrib.auth)、支持匿名会话(django.contrib.sessioins)以及用户评注系统(django.contrib.comments)。这些，我们将在第十六章详细讨论。在成为一个Django专家以前，你将会知道更多django.contrib的特性。 目前，你只需要知道Django自带很多优秀的附加组件，它们都存在于django.contrib包里。<br>激活管理界面</p>
<p>Django管理站点完全是可选择的，因为仅仅某些特殊类型的站点才需要这些功能。 这意味着你需要在你的项目中花费几个步骤去激活它。</p>
<p>第一步，对你的settings文件做如下这些改变：</p>
<pre><code>将&apos;django.contrib.admin&apos;加入setting的INSTALLED_APPS配置中 （INSTALLED_APPS中的配置顺序是没有关系的, 但是我们喜欢保持一定顺序以方便人来阅读）

保证INSTALLED_APPS中包含&apos;django.contrib.auth&apos;，&apos;django.contrib.contenttypes&apos;和&apos;django.contrib.sessions&apos;，Django的管理工具需要这3个包。 (如果你跟随本文制作mysite项目的话，那么请注意我们在第五章的时候把这三项INSTALLED_APPS条目注释了。现在，请把注释取消。)

确保MIDDLEWARE_CLASSES 包含&apos;django.middleware.common.CommonMiddleware&apos; 、&apos;django.contrib.sessions.middleware.SessionMiddleware&apos; 和&apos;django.contrib.auth.middleware.AuthenticationMiddleware&apos; 。(再次提醒，如果有跟着做mysite的话，请把在第五章做的注释取消。)
</code></pre><p>运行 python manage.py syncdb 。这一步将生成管理界面使用的额外数据库表。 当你把’django.contrib.auth’加进INSTALLED_APPS后，第一次运行syncdb命令时, 系统会请你创建一个超级用户。 如果你不这么作，你需要运行python manage.py createsuperuser来另外创建一个admin的用户帐号，否则你将不能登入admin (提醒一句: 只有当INSTALLED_APPS包含’django.contrib.auth’时，python manage.py createsuperuser这个命令才可用.)</p>
<p>第三，将admin访问配置在URLconf(记住，在urls.py中). 默认情况下，命令django-admin.py startproject生成的文件urls.py是将Django admin的路径注释掉的，你所要做的就是取消注释。 请注意，以下内容是必须确保存在的：</p>
<h1 id="Include-these-import-statements…"><a href="#Include-these-import-statements…" class="headerlink" title="Include these import statements…"></a>Include these import statements…</h1><p>from django.contrib import admin<br>admin.autodiscover()</p>
<h1 id="And-include-this-URLpattern…"><a href="#And-include-this-URLpattern…" class="headerlink" title="And include this URLpattern…"></a>And include this URLpattern…</h1><p>urlpatterns = patterns(‘’,</p>
<pre><code># ...
(r&apos;^admin/&apos;, include(admin.site.urls)),
# ...
</code></pre><p>)</p>
<p>当这一切都配置好后，现在你将发现Django管理工具可以运行了。 启动开发服务器(如前：<code>python manage.py runserver</code> )，然后在浏览器中访问：<a href="http://127.0.0.1:8000/admin/" target="_blank" rel="external">http://127.0.0.1:8000/admin/</a></p>
<p>，使用管理工具。</p>
<p>管理界面的设计是针对非技术人员的，所以它应该是自我解释的。 尽管如此，这里简单介绍一下它的基本特性。</p>
<p>你看到的第一件事是如图6-1所示的登录屏幕。</p>
<p>Django 登录页面的截图。</p>
<p>图 6-1. Django的登录截图</p>
<p>你要使用你原来设置的超级用户的用户名和密码。 如果无法登录，请运行<code>python manage.py createsuperuser</code> ，确保你已经创建了一个超级用户。</p>
<p>一旦登录了，你将看到管理页面。 这个页面列出了管理工具中可编辑的所有数据类型。 现在，由于我们还没有创建任何模块，所以这个列表只有寥寥数条类目： 它仅有两个默认的管理-编辑模块：用户组(Groups)和用户(Users)。</p>
<p>Django 主管理索引截图。</p>
<p>图 6-2。 Django admin的首页</p>
<p>在Django管理页面中，每一种数据类型都有一个<em> change list</em> 和<em> edit form</em> 。前者显示数据库中所有的可用对象；后者可让你添加、更改和删除数据库中的某条记录。</p>
<p>其它语言</p>
<p>如果你的母语不是英语，而你不想用它来配置你的浏览器，你可以做一个快速更改来观察Django管理工具是否被翻译成你想要的语言。 仅需添加<code>‘django.middleware.locale.LocaleMiddleware’</code> 到<code>MIDDLEWARE_CLASSES</code> 设置中，并确保它在’django.contrib.sessions.middleware.SessionMiddleware’<em> 之后</em> 。 （见上）</p>
<p>完成后，请刷新页面。 如果你设置的语言可用，一系列的链接文字将被显示成这种语言。这些文字包括页面顶端的Change password和Log out，页面中部的Groups和Users。 Django自带了多种语言的翻译。</p>
<p>关于Django更多的国际化特性，请参见第十九章。</p>
<p>点击Uers行中的Change链接，引导用户更改列表。</p>
<p>修改过的变更列表页面截图。</p>
<p>图 6-3. 典型的改变列表视图 （见上）</p>
<p>这个页面显示了数据库中所有的用户。你可以将它看作是一个漂亮的网页版查询：<code>SELECT * FROM auth_user;</code> 如果你一直跟着作练习，并且只添加了一个用户，你会在这个页面中看到一个用户。但是如果你添加了多个用户，你会发现页面中还有过滤器、排序和查询框。 过滤器在右边；排序功能可通过点击列头查看；查询框在页面顶部，它允许你通过用户名查询。</p>
<p>点击其中一个用户名，你会看见关于这个用户的编辑窗口。</p>
<p>典型的编辑表格截图。</p>
<p>图 6-4. 典型的编辑表格 （见上）</p>
<p>这个页面允许你修改用户的属性，如姓名和权限。 （如果要更改用户密码，你必须点击密码字段下的change password form，而不是直接更改字段值中的哈西码。）另外需要注意的是，不同类型的字段会用不同的窗口控件显示。例如，日期/时间型用日历控件，布尔型用复选框，字符型用简单文本框显示。</p>
<p>你可以通过点击编辑页面下方的删除按钮来删除一条记录。 你会见到一个确认页面。有时候，它会显示有哪些关联的对象将会一并被删除。 （例如，如果你要删除一个出版社，它下面所有的图书也将被删除。）</p>
<p>你可以通过点击管理主页面中某个对象的Add来添加一条新记录。 一个空白记录的页面将被打开，等待你填充。</p>
<p>你还能看到管理界面也控制着你输入的有效性。 你可以试试不填必需的栏目或者在时间栏里填错误的时间，你会发现当你要保存时会出现错误信息，如图6-5所示。<br>编辑表格显示错误信息的截图。</p>
<p>图6-5. 编辑表格显示错误信息 （见上）</p>
<p>当你编辑已有的对像时，你在窗口的右上角可以看到一个历史按钮。 通过管理界面做的每一个改变都留有记录，你可以按历史键来检查这个记录（见图6-6）。</p>
<p>Django 历史页面截图。</p>
<p>图6-6. Django 对像历史页面 （见上）</p>
<p>将你的Models加入到Admin管理中</p>
<p>有一个关键步骤我们还没做。 让我们将自己的模块加入管理工具中，这样我们就能够通过这个漂亮的界面添加、修改和删除数据库中的对象了。 我们将继续第五章中的<code>book</code> 例子。在其中，我们定义了三个模块： Publisher 、 Author 和 Book 。</p>
<p>在<code>books</code> 目录下(<code>mysite/books</code> )，创建一个文件：<code>admin.py</code> ，然后输入以下代码：</p>
<p>from django.contrib import admin<br>from mysite.books.models import Publisher, Author, Book</p>
<p>admin.site.register(Publisher)<br>admin.site.register(Author)<br>admin.site.register(Book)</p>
<p>这些代码通知管理工具为这些模块逐一提供界面。</p>
<p>完成后，打开页面 <code>http://127.0.0.1:8000/admin/</code> ，你会看到一个Books区域，其中包含Authors、Books和Publishers。  （你可能需要先停止，然后再启动服务(<code>runserver</code> )，才能使其生效。）</p>
<p>现在你拥有一个功能完整的管理界面来管理这三个模块了。 很简单吧！</p>
<p>花点时间添加和修改记录，以填充数据库。 如果你跟着第五章的例子一起创建Publisher对象的话（并且没有删除），你会在列表中看到那些记录。</p>
<p>这里需要提到的一个特性是，管理工具处理外键和多对多关系（这两种关系可以在<code>Book</code> 模块中找到）的方法。 作为提醒，这里有个<code>Book</code> 模块的例子：</p>
<p>class Book(models.Model):<br>    title = models.CharField(max_length=100)<br>    authors = models.ManyToManyField(Author)<br>    publisher = models.ForeignKey(Publisher)<br>    publication_date = models.DateField()</p>
<pre><code>def __unicode__(self):
    return self.title
</code></pre><p>在Add book页面中（<code>http://127.0.0.1:8000/admin/books/book/add/</code> ），<code>外键</code> publisher用一个选择框显示，<code>多对多</code> 字段author用一个多选框显示。 点击两个字段后面的绿色加号，可以让你添加相关的记录。 举个例子，如果你点击Publisher后面的加号，你将会得到一个弹出窗口来添加一个publisher。 当你在那个窗口中成功创建了一个publisher后，Add book表单会自动把它更新到字段上去 花巧.</p>
<p>Admin是如何工作的</p>
<p>在幕后，管理工具是如何工作的呢？ 其实很简单。</p>
<p>当服务启动时，Django从<code>url.py</code> 引导URLconf，然后执行<code>admin.autodiscover()</code> 语句。 这个函数遍历INSTALLED_APPS配置，并且寻找相关的 admin.py文件。 如果在指定的app目录下找到admin.py，它就执行其中的代码。</p>
<p>在<code>books</code> 应用程序目录下的<code>admin.py</code> 文件中，每次调用<code>admin.site.register()</code> 都将那个模块注册到管理工具中。 管理工具只为那些明确注册了的模块显示一个编辑/修改的界面。</p>
<p>应用程序<code>django.contrib.auth</code> 包含自身的<code>admin.py</code> ，所以Users和Groups能在管理工具中自动显示。 其它的django.contrib应用程序，如django.contrib.redirects，其它从网上下在的第三方Django应用程序一样，都会自行添加到管理工具。</p>
<p>综上所述，管理工具其实就是一个Django应用程序，包含自己的模块、模板、视图和URLpatterns。 你要像添加自己的视图一样，把它添加到URLconf里面。 你可以在Django基本代码中的django/contrib/admin 目录下，检查它的模板、视图和URLpatterns，但你不要尝试直接修改其中的任何代码，因为里面有很多地方可以让你自定义管理工具的工作方式。 （如果你确实想浏览Django管理工具的代码，请谨记它在读取关于模块的元数据过程中做了些不简单的工作，因此最好花些时间阅读和理解那些代码。）</p>
<p>设置字段可选</p>
<p>在摆弄了一会之后，你或许会发现管理工具有个限制：编辑表单需要你填写每一个字段，然而在有些情况下，你想要某些字段是可选的。 举个例子，我们想要Author模块中的email字段成为可选，即允许不填。 在现实世界中，你可能没有为每个作者登记邮箱地址。</p>
<p>为了指定email字段为可选，你只要编辑Book模块（回想第五章，它在mysite/books/models.py文件里），在email字段上加上blank=True。代码如下：</p>
<p>class Author(models.Model):<br>    first_name = models.CharField(max_length=30)<br>    last_name = models.CharField(max_length=40)<br>    email = models.EmailField(<strong>blank=True</strong> )</p>
<p>这些代码告诉Django，作者的邮箱地址允许输入一个空值。 所有字段都默认blank=False，这使得它们不允许输入空值。</p>
<p>这里会发生一些有趣的事情。 直到现在，除了<strong>unicode</strong>()方法，我们的模块充当数据库中表定义的角色，即本质上是用Python的语法来写CREATE TABLE语句。 在添加blank=True过程中，我们已经开始在简单的定义数据表上扩展我们的模块了。 现在，我们的模块类开始成为一个富含Author对象属性和行为的集合了。 email不但展现为一个数据库中的VARCHAR类型的字段，它还是页面中可选的字段，就像在管理工具中看到的那样。</p>
<p>当你添加blank=True以后，刷新页面Add author edit form (<a href="http://127.0.0.1:8000/admin/books/author/add/" target="_blank" rel="external">http://127.0.0.1:8000/admin/books/author/add/</a> )，将会发现Email的标签不再是粗体了。 这意味它不是一个必填字段。 现在你可以添加一个作者而不必输入邮箱地址，即使你为这个字段提交了一个空值，也再不会得到那刺眼的红色信息“This field is required”。<br>设置日期型和数字型字段可选</p>
<p>虽然blank=True同样适用于日期型和数字型字段，但是这里需要详细讲解一些背景知识。</p>
<p>SQL有指定空值的独特方式，它把空值叫做NULL。NULL可以表示为未知的、非法的、或其它程序指定的含义。</p>
<p>在SQL中， NULL的值不同于空字符串，就像Python中None不同于空字符串（””）一样。这意味着某个字符型字段（如VARCHAR）的值不可能同时包含NULL和空字符串。</p>
<p>这会引起不必要的歧义或疑惑。 为什么这条记录有个NULL，而那条记录却有个空字符串？ 它们之间有区别，还是数据输入不一致？ 还有： 我怎样才能得到全部拥有空值的记录，应该按NULL和空字符串查找么？还是仅按字符串查找？</p>
<p>为了消除歧义，Django生成CREATE TABLE语句自动为每个字段显式加上NOT NULL。 这里有个第五章中生成Author模块的例子：</p>
<p>CREATE TABLE “books_author” (<br>    “id” serial NOT NULL PRIMARY KEY,<br>    “first_name” varchar(30) NOT NULL,<br>    “last_name” varchar(40) NOT NULL,<br>    “email” varchar(75) NOT NULL<br>)<br>;</p>
<p>在大多数情况下，这种默认的行为对你的应用程序来说是最佳的，因为它可以使你不再因数据一致性而头痛。 而且它可以和Django的其它部分工作得很好。如在管理工具中，如果你留空一个字符型字段，它会为此插入一个空字符串（而<em> 不是</em>NULL）。</p>
<p>但是，其它数据类型有例外：日期型、时间型和数字型字段不接受空字符串。 如果你尝试将一个空字符串插入日期型或整数型字段，你可能会得到数据库返回的错误，这取决于那个数据库的类型。 （PostgreSQL比较严禁，会抛出一个异常；MySQL可能会也可能不会接受，这取决于你使用的版本和运气了。）在这种情况下，NULL是唯一指定空值的方法。 在Django模块中，你可以通过添加null=True来指定一个字段允许为NULL。</p>
<p>因此，这说起来有点复杂： 如果你想允许一个日期型（DateField、TimeField、DateTimeField）或数字型（IntegerField、DecimalField、FloatField）字段为空，你需要使用null=True <em> 和</em> blank=True。</p>
<p>为了举例说明，让我们把Book模块修改成允许 publication_date为空。修改后的代码如下：</p>
<p>class Book(models.Model):<br>    title = models.CharField(max_length=100)<br>    authors = models.ManyToManyField(Author)<br>    publisher = models.ForeignKey(Publisher)<br>    publication_date = models.DateField(<strong>blank=True, null=True</strong> )</p>
<p>添加null=True比添加blank=True复杂。因为null=True改变了数据的语义，即改变了CREATE TABLE语句，把publication_date字段上的NOT NULL删除了。 要完成这些改动，我们还需要更新数据库。</p>
<p>出于某种原因，Django不会尝试自动更新数据库结构。所以你必须执行ALTER TABLE语句将模块的改动更新至数据库。 像先前那样，你可以使用manage.py dbshell进入数据库服务环境。 以下是在这个特殊情况下如何删除NOT NULL:</p>
<p>ALTER TABLE books_book ALTER COLUMN publication_date DROP NOT NULL;</p>
<p>（注意：以下SQL语法是PostgreSQL特有的。）</p>
<p>我们将在第十章详细讲述数据库结构更改。</p>
<p>现在让我们回到管理工具，添加book的编辑页面允许输入一个空的publication date。<br>自定义字段标签</p>
<p>在编辑页面中，每个字段的标签都是从模块的字段名称生成的。 规则很简单： 用空格替换下划线；首字母大写。例如：Book模块中publication_date的标签是Publication date。</p>
<p>然而，字段名称并不总是贴切的。有些情况下，你可能想自定义一个标签。 你只需在模块中指定verbose_name。</p>
<p>举个例子，说明如何将Author.email的标签改为e-mail，中间有个横线。</p>
<p>class Author(models.Model):<br>    first_name = models.CharField(max_length=30)<br>    last_name = models.CharField(max_length=40)<br>    email = models.EmailField(blank=True, <strong>verbose_name=’e-mail’</strong> )</p>
<p>修改后重启服务器，你会在author编辑页面中看到这个新标签。</p>
<p>请注意，你不必把verbose_name的首字母大写，除非是连续大写（如：”USA state”）。Django会自动适时将首字母大写，并且在其它不需要大写的地方使用verbose_name的精确值。</p>
<p>最后还需注意的是，为了使语法简洁，你可以把它当作固定位置的参数传递。 这个例子与上面那个的效果相同。</p>
<p>class Author(models.Model):<br>    first_name = models.CharField(max_length=30)<br>    last_name = models.CharField(max_length=40)<br>    email = models.EmailField(<strong>‘e-mail’,</strong>  blank=True)</p>
<p>但这不适用于ManyToManyField 和ForeignKey字段，因为它们第一个参数必须是模块类。 那种情形，必须显式使用verbose_name这个参数名称。</p>
<p>自定义ModelAdmi类</p>
<p>迄今为止，我们做的blank=True、null=True和verbose_name修改其实是模块级别，而不是管理级别的。 也就是说，这些修改实质上是构成模块的一部分，并且正好被管理工具使用，而不是专门针对管理工具的。</p>
<p>除了这些，Django还提供了大量选项让你针对特别的模块自定义管理工具。 这些选项都在ModelAdmin classes里面，这些类包含了管理工具中针对特别模块的配置。</p>
<p>自定义列表</p>
<p>让我们更深一步：自定义Author模块的列表中的显示字段。 列表默认地显示查询结果中对象的<strong>unicode</strong>()。 在第五章中，我们定义Author对象的<strong>unicode</strong>()方法，用以同时显示作者的姓和名。</p>
<p>class Author(models.Model):<br>    first_name = models.CharField(max_length=30)<br>    last_name = models.CharField(max_length=40)<br>    email = models.EmailField(blank=True, verbose_name=’e-mail’)</p>
<pre><code>**def __unicode__(self):**
    **return u&apos;%s %s&apos; % (self.first_name, self.last_name)**
</code></pre><p>结果正如图6-7所示，列表中显示的是每个作者的姓名。</p>
<p>Screenshot of the author change list page.</p>
<p>图 6-7. 作者列表</p>
<p>我们可以在这基础上改进，添加其它字段，从而改变列表的显示。 这个页面应该提供便利，比如说：在这个列表中可以看到作者的邮箱地址。如果能按照姓氏或名字来排序，那就更好了。</p>
<p>为了达到这个目的，我们将为Author模块定义一个ModelAdmin类。 这个类是自定义管理工具的关键，其中最基本的一件事情是允许你指定列表中的字段。 打开admin.py并修改：</p>
<p>from django.contrib import admin<br>from mysite.books.models import Publisher, Author, Book</p>
<p><strong>class AuthorAdmin(admin.ModelAdmin):</strong><br>    <strong>list_display = (‘first_name’, ‘last_name’, ‘email’)</strong></p>
<p>admin.site.register(Publisher)<br><strong>admin.site.register(Author, AuthorAdmin)</strong><br>admin.site.register(Book)</p>
<p>解释一下代码：</p>
<pre><code>我们新建了一个类AuthorAdmin，它是从django.contrib.admin.ModelAdmin派生出来的子类，保存着一个类的自定义配置，以供管理工具使用。 我们只自定义了一项：list_display， 它是一个字段名称的元组，用于列表显示。 当然，这些字段名称必须是模块中有的。


我们修改了admin.site.register()调用，在Author后面添加了AuthorAdmin。你可以这样理解： 用AuthorAdmin选项注册Author模块。

admin.site.register()函数接受一个ModelAdmin子类作为第二个参数。 如果你忽略第二个参数，Django将使用默认的选项。Publisher和Book的注册就属于这种情况。
</code></pre><p>弄好了这个东东，再刷新author列表页面，你会看到列表中有三列：姓氏、名字和邮箱地址。 另外，点击每个列的列头可以对那列进行排序。 （参见图 6-8）</p>
<p>Screenshot of the author change list page after list_display.</p>
<p>图 6-8. 修改后的author列表页面</p>
<p>接下来，让我们添加一个快速查询栏。 向AuthorAdmin追加search_fields，如：</p>
<p>class AuthorAdmin(admin.ModelAdmin):<br>    list_display = (‘first_name’, ‘last_name’, ‘email’)<br>    <strong>search_fields = (‘first_name’, ‘last_name’)</strong></p>
<p>刷新浏览器，你会在页面顶端看到一个查询栏。 （见图6-9.）我们刚才所作的修改列表页面，添加了一个根据姓名查询的查询框。 正如用户所希望的那样，它是大小写敏感，并且对两个字段检索的查询框。如果查询”bar”，那么名字中含有Barney和姓氏中含有Hobarson的作者记录将被检索出来。</p>
<p>Screenshot of the author change list page after search_fields.</p>
<p>图 6-9. 含search_fields的author列表页面</p>
<p>接下来，让我们为Book列表页添加一些过滤器。</p>
<p>from django.contrib import admin<br>from mysite.books.models import Publisher, Author, Book</p>
<p>class AuthorAdmin(admin.ModelAdmin):<br>    list_display = (‘first_name’, ‘last_name’, ‘email’)<br>    search_fields = (‘first_name’, ‘last_name’)</p>
<p><strong>class BookAdmin(admin.ModelAdmin):</strong><br>    <strong>list_display = (‘title’, ‘publisher’, ‘publication_date’)</strong><br>    <strong>list_filter = (‘publication_date’,)</strong></p>
<p>admin.site.register(Publisher)<br>admin.site.register(Author, AuthorAdmin)<br><strong>admin.site.register(Book, BookAdmin)</strong></p>
<p>由于我们要处理一系列选项，因此我们创建了一个单独的ModelAdmin类：BookAdmin。首先，我们定义一个list_display，以使得页面好看些。 然后，我们用list_filter这个字段元组创建过滤器，它位于列表页面的右边。 Django为日期型字段提供了快捷过滤方式，它包含：今天、过往七天、当月和今年。这些是开发人员经常用到的。 图 6-10显示了修改后的页面。</p>
<p>Screenshot of the book change list page after list_filter.</p>
<p>图 6-10. 含过滤器的book列表页面</p>
<p><code>过滤器</code> 同样适用于其它类型的字段，而不单是<code>日期型</code> （请在<code>布尔型</code> 和<code>外键</code> 字段上试试）。当有两个以上值时，过滤器就会显示。</p>
<p>另外一种过滤日期的方式是使用date_hierarchy选项，如：</p>
<p>class BookAdmin(admin.ModelAdmin):<br>    list_display = (‘title’, ‘publisher’, ‘publication_date’)<br>    list_filter = (‘publication_date’,)<br>    <strong>date_hierarchy = ‘publication_date’</strong></p>
<p>修改好后，页面中的列表顶端会有一个逐层深入的导航条，效果如图 6-11. 它从可用的年份开始，然后逐层细分到月乃至日。</p>
<p>Screenshot of the book change list page after date_hierarchy.</p>
<p>图 6-11. 含date_hierarchy的book列表页面</p>
<p>请注意，date_hierarchy接受的是<em> 字符串</em> ，而不是元组。因为只能对一个日期型字段进行层次划分。</p>
<p>最后，让我们改变默认的排序方式，按publication date降序排列。 列表页面默认按照模块class Meta（详见第五章）中的ordering所指的列排序。但目前没有指定ordering值，所以当前排序是没有定义的。</p>
<p>class BookAdmin(admin.ModelAdmin):<br>    list_display = (‘title’, ‘publisher’, ‘publication_date’)<br>    list_filter = (‘publication_date’,)<br>    date_hierarchy = ‘publication_date’<br>    <strong>ordering = (‘-publication_date’,)</strong></p>
<p>这个ordering选项基本像模块中class Meta的ordering那样工作，除了它只用列表中的第一个字段名。 如果要实现降序，仅需在传入的列表或元组的字段前加上一个减号(-)。</p>
<p>刷新book列表页面观看实际效果。 注意Publication date列头现在有一个小箭头显示排序。 （见图 6-12.）</p>
<p>Screenshot of the book change list page after ordering.</p>
<p>图 6-12 含排序的book列表页面</p>
<p>我们已经学习了主要的选项。 通过使用它们，你可以仅需几行代码就能创建一个功能强大、随时上线的数据编辑界面。<br>自定义编辑表单</p>
<p>正如自定义列表那样，编辑表单多方面也能自定义。</p>
<p>首先，我们先自定义字段顺序。 默认地，表单中的字段顺序是与模块中定义是一致的。 我们可以通过使用ModelAdmin子类中的fields选项来改变它：</p>
<p>class BookAdmin(admin.ModelAdmin):<br>    list_display = (‘title’, ‘publisher’, ‘publication_date’)<br>    list_filter = (‘publication_date’,)<br>    date_hierarchy = ‘publication_date’<br>    ordering = (‘-publication_date’,)<br>    <strong>fields = (‘title’, ‘authors’, ‘publisher’, ‘publication_date’)</strong></p>
<p>完成之后，编辑表单将按照指定的顺序显示各字段。 它看起来自然多了——作者排在书名之后。 字段顺序当然是与数据条目录入顺序有关， 每个表单都不一样。</p>
<p>通过fields这个选项，你可以排除一些不想被其他人编辑的fields 只要不选上不想被编辑的field(s)即可。 当你的admi用户只是被信任可以更改你的某一部分数据时，或者，你的数据被一些外部的程序自动处理而改变了了，你就可以用这个功能。 例如，在book数据库中，我们可以隐藏publication_date，以防止它被编辑。</p>
<p>class BookAdmin(admin.ModelAdmin):<br>    list_display = (‘title’, ‘publisher’, ‘publication_date’)<br>    list_filter = (‘publication_date’,)<br>    date_hierarchy = ‘publication_date’<br>    ordering = (‘-publication_date’,)<br>    <strong>fields = (‘title’, ‘authors’, ‘publisher’)</strong></p>
<p>这样，在编辑页面就无法对publication date进行改动。 如果你是一个编辑，不希望作者推迟出版日期的话，这个功能就很有用。 （当然，这纯粹是一个假设的例子。）</p>
<p>当一个用户用这个不包含完整信息的表单添加一本新书时，Django会简单地将publication_date设置为None，以确保这个字段满足null=True的条件。</p>
<p>另一个常用的编辑页面自定义是针对多对多字段的。 真如我们在book编辑页面看到的那样，<code>多对多字段</code> 被展现成多选框。虽然多选框在逻辑上是最适合的HTML控件，但它却不那么好用。 如果你想选择多项，你必须还要按下Ctrl键（苹果机是command键）。 虽然管理工具因此添加了注释（help_text），但是当它有几百个选项时，它依然显得笨拙。</p>
<p>更好的办法是使用filter_horizontal。让我们把它添加到BookAdmin中，然后看看它的效果。</p>
<p>class BookAdmin(admin.ModelAdmin):<br>    list_display = (‘title’, ‘publisher’, ‘publication_date’)<br>    list_filter = (‘publication_date’,)<br>    date_hierarchy = ‘publication_date’<br>    ordering = (‘-publication_date’,)<br>    <strong>filter_horizontal = (‘authors’,)</strong></p>
<p>（如果你一着跟着做练习，请注意移除fields选项，以使得编辑页面包含所有字段。）</p>
<p>刷新book编辑页面，你会看到Author区中有一个精巧的JavaScript过滤器，它允许你检索选项，然后将选中的authors从Available框移到Chosen框，还可以移回来。</p>
<p>Screenshot of the book edit form after adding filter_horizontal.</p>
<p>图 6-13. 含filter_horizontal的book编辑页面</p>
<p>我们强烈建议针对那些拥有十个以上选项的<code>多对多字段</code> 使用filter_horizontal。 这比多选框好用多了。 你可以在多个字段上使用filter_horizontal，只需在这个元组中指定每个字段的名字。</p>
<p>ModelAdmin类还支持filter_vertical选项。 它像filter_horizontal那样工作，除了控件都是垂直排列，而不是水平排列的。 至于使用哪个，只是个人喜好问题。</p>
<p>filter_horizontal和filter_vertical选项只能用在多对多字段 上, 而不能用于 ForeignKey字段。 默认地，管理工具使用<code>下拉框</code> 来展现<code>外键</code> 字段。但是，正如<code>多对多字段</code> 那样，有时候你不想忍受因装载并显示这些选项而产生的大量开销。 例如，我们的book数据库膨胀到拥有数千条publishers的记录，以致于book的添加页面装载时间较久，因为它必须把每一个publishe都装载并显示在<code>下拉框</code> 中。</p>
<p>解决这个问题的办法是使用<code>raw_id_fields</code> 选项。它是一个包含外键字段名称的元组，它包含的字段将被展现成<code>文本框</code> ，而不再是<code>下拉框</code> 。见图 6-14。</p>
<p>class BookAdmin(admin.ModelAdmin):<br>    list_display = (‘title’, ‘publisher’, ‘publication_date’)<br>    list_filter = (‘publication_date’,)<br>    date_hierarchy = ‘publication_date’<br>    ordering = (‘-publication_date’,)<br>    filter_horizontal = (‘authors’,)<br>    <strong>raw_id_fields = (‘publisher’,)</strong></p>
<p>Screenshot of edit form after raw_id_fields.</p>
<p>图 6-14. 含raw_id_fields的book编辑页面</p>
<p>在这个输入框中，你输入什么呢？ publisher的数据库ID号。 考虑到人们通常不会记住这些数据库ID，管理工具提供了一个放大镜图标方便你输入。点击那个图标将会弹出一个窗口，在那里你可以选择想要添加的publishe。</p>
<p>用户、用户组和权限</p>
<p>因为你是用超级用户登录的，你可以创建，编辑和删除任何对像。 然而，不同的环境要求有不同的权限，系统不允许所有人都是超级用户。 管理工具有一个用户权限系统，通过它你可以根据用户的需要来指定他们的权限，从而达到部分访问系统的目的。</p>
<p>用户帐号应该是通用的、独立于管理界面以外仍可以使用。但我们现在把它看作是管理界面的一部分。 在第十四章，我们将讲述如何把用户帐号与你的网站（不仅仅是管理工具）集成在一起。</p>
<p>你通过管理界面编辑用户及其许可就像你编辑别的对象一样。 我们在本章的前面，浏览用户和用户组区域的时候已经见过这些了。 如你所想，用户对象有标准的用户名、密码、邮箱地址和真实姓名，同时它还有关于使用管理界面的权限定义。 首先，这有一组三个布尔型标记：</p>
<pre><code>活动标志，它用来控制用户是否已经激活。 如果一个用户帐号的这个标记是关闭状态，而用户又尝试用它登录时，即使密码正确，他也无法登录系统。

成员标志，它用来控制这个用户是否可以登录管理界面（即：这个用户是不是你们组织里的成员） 由于用户系统可以被用于控制公众页面（即：非管理页面）的访问权限（详见第十四章），这个标志可用来区分公众用户和管理用户。

超级用户标志，它赋予用户在管理界面中添加、修改和删除任何项目的权限。 如果一个用户帐号有这个标志，那么所有权限设置（即使没有）都会被忽略。
</code></pre><p>普通的活跃，非超级用户的管理用户可以根据一套设定好的许可进入。 管理界面中每种可编辑的对象（如：books、authors、publishers）都有三种权限： 创建 许可， 编辑 许可和 删除 许可。 给一个用户授权许可也就表明该用户可以进行许可描述的操作。</p>
<p>当你创建一个用户时，它没有任何权限，该有什么权限是由你决定的。 例如，你可以给一个用户添加和修改publishers的权限，而不给他删除的权限。 请注意，这些权限是定义在模块级别上，而不是对象级别上的。据个例子，你可以让小强修改任何图书，但是不能让他仅修改由机械工业出版社出版的图书。 后面这种基于对象级别的权限设置比较复杂，并且超出了本书的覆盖范围，但你可以在Django documentation中寻找答案。</p>
<p>注释</p>
<p>权限管理系统也控制编辑用户和权限。 如果你给某人编辑用户的权限，他可以编辑自己的权限，这种能力可能不是你希望的。 赋予一个用户修改用户的权限，本质上说就是把他变成一个超级用户。</p>
<p>你也可以给组中分配用户。 一个 组 简化了给组中所有成员应用一套许可的动作。 组在给大量用户特定权限的时候很有用。<br>何时、为什么使用管理界面？何时又不使用呢？</p>
<p>经过这一章的学习，你应该对Django管理工具有所认识。 但是我们需要表明一个观点：<em> 什么时候</em> 、<em> 为什么</em> 用，以及什么时候又<em> 不</em> 用。</p>
<p>Django的管理界面对非技术用户要输入他们的数据时特别有用；事实上这个特性就是专门为这个 实现的。 在Django最开始开发的新闻报道的行业应用中，有一个典型的在线自来水的水质专题报道 应用，它的实现流程是这样的：</p>
<pre><code>负责这个报道的记者和要处理数据的开发者碰头，提供一些数据给开发者。

开发者围绕这些数据设计模型然后配置一个管理界面给记者。

记者检查管理界面，尽早指出缺少或多余的字段。 开发者来回地修改模块。
22

当模块认可后，记者就开始用管理界面输入数据。 同时，程序员可以专注于开发公众访问视图和模板（有趣的部分）。
</code></pre><p>换句话说，Django的管理界面为内容输入人员和编程人员都提供了便利的工具。</p>
<p>当然，除了数据输入方面，我们发现管理界面在下面这些情景中也是很有用的：</p>
<pre><code>检查模块* ：当你定义好了若干个模块，在管理页面中把他们调出来然后输入一些虚假的数据，这是相当有用的。 有时候，它能显示数据建模的错误或者模块中其它问题。


管理既得数据* ：如果你的应用程序依赖外部数据（来自用户输入或网络爬虫），管理界面提供了一个便捷的途径，让你检查和编辑那些数据。 你可以把它看作是一个功能不那么强大，但是很方便的数据库命令行工具。

临时的数据管理程序* ：你可以用管理工具建立自己的轻量级数据管理程序，比如说开销记录。 如果你正在根据自己的，而不是公众的需要开发些什么，那么管理界面可以带给你很大的帮助。 从这个意义上讲，你可以把它看作是一个增强的关系型电子表格。
</code></pre><p>最后一点要澄清的是： 管理界面不是终结者。 过往许多年间，我们看到它被拆分、修改成若干个功能模块，而这些功能不是它所支持的。 它不应成为一个<em> 公众</em> 数据访问接口，也不应允许对你的数据进行复杂的排序和查询。 正如本章开头所说，它仅提供给可信任的管理员。 请记住这一点，它是有效使用管理界面的钥匙。</p>
<p>下一章</p>
<p>到现在，我们已经创建了一些模块，并且为编辑数据配置了一个优秀的界面。 <code>下一章 &lt;../chapter07/&gt;</code>__ ，我们将转入到网站开发中最重要的部分： 表单的创建和处理。</p>

      
    </div>

    <div>
      
        
<div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center">
  <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
  <button id="rewardButton", disable="enable", onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}", style="cursor: pointer; border: 0; outline: 0; border-radius: 100%; padding: 0; margin: 0; letter-spacing: normal; text-transform: none; text-indent: 0px; text-shadow: none">
    <span onmouseover="this.style.color='rgb(236,96,0)';this.style.background='rgb(204,204,204)'" onMouseOut="this.style.color='#fff';this.style.background='rgb(236,96,0)'" style="display: inline-block; width: 70px; height: 70px; border-radius: 100%; line-height: 81px; color: #fff; font: 400 35px/75px 'microsofty'; background: rgb(236,96,0)">赏</span>
  </button>
  <div id="QR" style="display: none;">
    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/weixin.jpg" alt="爱像水墨青花 WeChat Pay" style="width: 200px; max-width: 100%; display: inline-block"/>
        <p>微信打赏</p>
      </div>
    
    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="爱像水墨青花 Alipay" style="width: 200px; max-width: 100%; display: inline-block"/>
        <p>支付宝打赏</p>
      </div>
    
  </div>
</div>

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/django/" rel="tag">#django</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/04/06/2016-02-02-第5章 模型/" rel="next" title="第5章 模型">
                <i class="fa fa-chevron-left"></i> 第5章 模型
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/04/06/2016-02-03-高瞻远瞩/" rel="prev" title="友情链接">
                友情链接 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <div class="ds-share flat" data-thread-key="2016/04/06/2016-02-03-第六章 Django站点管理/"
     data-title="第六章 Django站点管理"
     data-content=""
     data-url="http://www.lflxp.cn/2016/04/06/2016-02-03-第六章 Django站点管理/">
  <div class="ds-share-inline">
    <ul  class="ds-share-icons-16">

      <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
      <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
      <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
      <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
      <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

    </ul>
    <div class="ds-share-icons-more">
    </div>
  </div>
</div>
      
    </div>
  </div>


          </div>
          

  <p>热评文章</p>
  <div class="ds-top-threads" data-range="weekly" data-num-items="4"></div>


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/04/06/2016-02-03-第六章 Django站点管理/"
           data-title="第六章 Django站点管理" data-url="http://www.lflxp.cn/2016/04/06/2016-02-03-第六章 Django站点管理/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/123.jpg"
               alt="爱像水墨青花" />
          <p class="site-author-name" itemprop="name">爱像水墨青花</p>
          <p class="site-description motion-element" itemprop="description">控制自己就能控制世界</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">31</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/lflxp" target="_blank">
                  
                    <i class="fa fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.lflxp.cn" target="_blank">
                  
                    <i class="fa fa-twitter"></i>
                  
                  我的博客
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://aws.lflxp.cn" target="_blank">
                  
                    <i class="fa fa-weibo"></i>
                  
                  管理系统
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.baidu.com" target="_blank">
                  
                    <i class="fa fa-phone"></i>
                  
                  百度
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://godoc.org" target="_blank">
                  
                    <i class="fa fa-thumbs-up"></i>
                  
                  GoDoc
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://aws.amazon.com/cn" target="_blank">
                  
                    <i class="fa fa-thumbs-up"></i>
                  
                  Aws
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://theme-next.iissnan.com/getting-started.html" target="_blank">
                  
                    <i class="fa fa-thumbs-up"></i>
                  
                  NexT
                </a>
              </span>
            
          
        </div>

        
        

        
        <div class="links-of-blogroll motion-element">
          
            <div class="links-of-blogroll-title">Links</div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://aws.lflxp.cn/" target="_blank">监控平台</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://wrapbootstrap.com/preview/WB0R5L90S" target="_blank">监控专业平台</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.jiankongbao.com/new_server" target="_blank">监控宝（原型）</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://lflxp.cn" target="_blank">我的博客</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://github.com/lixueping" target="_blank">GITHUB-lixueping</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://github.com/lflxp" target="_blank">GITHUB-lflxp</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.godoc.org" target="_blank">Golang</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.baidu.com" target="_blank">PHP</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://Python.org" target="_blank">Python</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://developer.baidu.com/bae/" target="_blank">百度BAE</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://sofar.blog.51cto.com/353572/1601552" target="_blank">Mysql_altas</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://almsaeedstudio.com/blog/10-Free-Responsive-Bootstrap-Templates-For-2016" target="_blank">网站模板</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://aws.amazon.com/cn" target="_blank">亚马逊AWS</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://github.com/kubernetes" target="_blank">Docker 集群编排系统kubernetes</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://kubernetes.io/v1.1/docs/getting-started-guides/README.html" target="_blank">kubernetes 官网</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://github.com/coreos/etcd" target="_blank">etcd服务发现github</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://coreos.com/etcd/" target="_blank">etcd 官网</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://git-scm.com/download/" target="_blank">git</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://help.github.com/" target="_blank">GitHub</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://godoc.org/" target="_blank">godoc</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://wanwang.aliyun.com" target="_blank">中国万网</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.mysql.com/" target="_blank">mysql</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.oracle.com/index.html" target="_blank">oracle</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.mongodb.com/" target="_blank">mongodb</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://hortonworks.com/hdp/whats-new/" target="_blank">HDP 2.3</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://djangobook.py3k.cn/2.0/" target="_blank">DjangoBook2.0 学习</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.iteedu.com/webtech/python/djangocn2/chapter06.php" target="_blank">DjangoBook2.0 有图片</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://docs.djangoproject.com/en/dev/howto/custom-template-tags/" target="_blank">Custom template tags and filters</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://docs.djangoproject.com/en/dev/ref/contrib/messages/" target="_blank">The messages framework</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://docs.djangoproject.com/en/dev/howto/outputting-csv/" target="_blank">Outputting CSV with Django</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://python.jobbole.com/81312/" target="_blank">Sublime Text3</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://su.baidu.com/" target="_blank">百度云CDN加速</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://jingyan.baidu.com/article/27fa7326e7208946f9271f67.html?qq-pf-to=pcqq.c2c" target="_blank">百度云CDN配置</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://go.lflxp.cn" target="_blank">GO语言圣经</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://github.com/astaxie/Go-in-Action/blob/master/ebook/zh/preface.md" target="_blank">Go实战开发之目录</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://davidstutz.github.io/bootstrap-multiselect/" target="_blank">Bootstrap-multiselect</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.jb51.net/LINUXjishu/409416.html" target="_blank">vagrant使用</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.vagrantbox.es/" target="_blank">vagrant官网资源下载</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://coreos.com/" target="_blank">CoreOs</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://echarts.baidu.com.cn/examples.html" target="_blank">ECharts</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://my.oschina.net/dddttttt/blog/304200" target="_blank">Django模板标签</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://docs.docker.com/engine/reference/builder/" target="_blank">DockerFile Builder</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://pengky.cn/zindex01.html" target="_blank">新能源科学技术</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://github.com/kalcaddle/KODExplorer" target="_blank">KODExplorer</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://code.youmeek.com/2016/02/28/2016/02/Hexo/#footer" target="_blank">Github 空间搭建 Hexo</a>
                </li>
              
            </ul>
          
        </div>

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Include-these-import-statements…"><span class="nav-number">1.</span> <span class="nav-text">Include these import statements…</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#And-include-this-URLpattern…"><span class="nav-number">2.</span> <span class="nav-text">And include this URLpattern…</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">爱像水墨青花</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=0.5.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=0.5.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"lflxp"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
      <script src="/vendors/ua-parser-js/dist/ua-parser.min.js"></script>
      <script src="/js/src/hook-duoshuo.js"></script>
    
  





  
  
  

  

  

</body>
</html>
